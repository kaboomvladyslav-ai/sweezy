"use client"\nimport { useEffect, useState } from 'react'\nimport { Dialog, DialogContent, DialogDescription, DialogHeader, DialogTitle, DialogTrigger } from '@/components/ui/dialog'\nimport { Button } from '@/components/ui/button'\nimport UIInput from '@/components/ui/input'\nimport { useQueryClient } from '@tanstack/react-query'\nimport { toast } from 'react-hot-toast'\nimport { News } from '@/lib/types'\n\nexport default function NewsEditorDialog({ news, trigger }: { news?: News; trigger?: React.ReactNode }) {\n  const [isOpen, setIsOpen] = useState(false)\n  const [title, setTitle] = useState(news?.title ?? '')\n  const [summary, setSummary] = useState(news?.summary ?? '')\n  const [url, setUrl] = useState(news?.url ?? '')\n  const [source, setSource] = useState(news?.source ?? 'Sweezy')\n  const [language, setLanguage] = useState(news?.language ?? 'uk')\n  const [publishedAt, setPublishedAt] = useState<string>(news?.published_at ?? new Date().toISOString())\n  const [imageUrl, setImageUrl] = useState(news?.image_url ?? '')\n  const [loading, setLoading] = useState(false)\n  const qc = useQueryClient()\n\n  useEffect(() => {\n    if (isOpen) {\n      setTitle(news?.title ?? '')\n      setSummary(news?.summary ?? '')\n      setUrl(news?.url ?? '')\n      setSource(news?.source ?? 'Sweezy')\n      setLanguage(news?.language ?? 'uk')\n      setPublishedAt(news?.published_at ?? new Date().toISOString())\n      setImageUrl(news?.image_url ?? '')\n    }\n  }, [isOpen, news])\n\n  const submit = async () => {\n    setLoading(true)\n    try {\n      const payload = { title, summary, url, source, language, published_at: publishedAt, image_url: imageUrl || undefined }\n      const res = await fetch(news ? `/api/news/${news.id}` : `/api/news`, {\n        method: news ? 'PUT' : 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify(payload)\n      })\n      if (!res.ok) throw new Error(await res.text())\n      toast.success(news ? 'News updated' : 'News created')\n      setIsOpen(false)\n      qc.invalidateQueries({ queryKey: ['news'] })\n    } catch (e: any) {\n      toast.error(e?.message || 'Failed to save news')\n    } finally {\n      setLoading(false)\n    }\n  }\n\n  return (\n    <Dialog open={isOpen} onOpenChange={setIsOpen}>\n      <DialogTrigger asChild>\n        {trigger || <Button variant=\"primary\">Create News</Button>}\n      </DialogTrigger>\n      <DialogContent className=\"sm:max-w-2xl max-h-[85vh] overflow-y-auto\">\n        <DialogHeader>\n          <DialogTitle>{news ? 'Edit News' : 'Create News'}</DialogTitle>\n          <DialogDescription>Manage a news item that appears in What’s New.</DialogDescription>\n        </DialogHeader>\n        <div className=\"grid gap-3 py-2\">\n          <UIInput label=\"Title\" value={title} onChange={e=>setTitle(e.target.value)} />\n          <UIInput label=\"Summary\" value={summary} onChange={e=>setSummary(e.target.value)} />\n          <UIInput label=\"URL\" value={url} onChange={e=>setUrl(e.target.value)} />\n          <div className=\"grid grid-cols-1 sm:grid-cols-3 gap-2\">\n            <UIInput label=\"Source\" value={source} onChange={e=>setSource(e.target.value)} />\n            <UIInput label=\"Language\" value={language} onChange={e=>setLanguage(e.target.value)} />\n            <UIInput label=\"Published At (ISO)\" value={publishedAt} onChange={e=>setPublishedAt(e.target.value)} />\n          </div>\n          <UIInput label=\"Image URL\" value={imageUrl} onChange={e=>setImageUrl(e.target.value)} />\n        </div>\n        <div className=\"flex justify-end\">\n          <Button onClick={submit} disabled={loading}>{loading ? 'Saving…' : 'Save'}</Button>\n        </div>\n      </DialogContent>\n    </Dialog>\n  )\n}\n\n*** End Patch"} ?>>

